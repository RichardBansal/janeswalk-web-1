(function(b){function E(a,c,e){var d=this;return this.on("click.pjax",a,function(a){var f=b.extend({},q(c,e));f.container||(f.container=b(this).attr("data-pjax")||d);x(a,f)})}function x(a,c,e){e=q(c,e);c=a.currentTarget;if("A"!==c.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(1<a.which||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey||location.protocol!==c.protocol||location.hostname!==c.hostname||c.hash&&c.href.replace(c.hash,"")===location.href.replace(location.hash,
"")||c.href===location.href+"#")){var d={url:c.href,container:b(c).attr("data-pjax"),target:c};e=b.extend({},d,e);d=b.Event("pjax:click");b(c).trigger(d,[e]);d.isDefaultPrevented()||(f(e),a.preventDefault())}}function F(a,c,e){e=q(c,e);c=a.currentTarget;if("FORM"!==c.tagName.toUpperCase())throw"$.pjax.submit requires a form element";c={type:c.method.toUpperCase(),url:c.action,data:b(c).serializeArray(),container:b(c).attr("data-pjax"),target:c};f(b.extend({},c,e));a.preventDefault()}function f(a){function c(a,
c){var d=b.Event(a,{relatedTarget:e});k.trigger(d,c);return!d.isDefaultPrevented()}a=b.extend(!0,{},b.ajaxSettings,f.defaults,a);b.isFunction(a.url)&&(a.url=a.url());var e=a.target,d=t(a.url).hash,k=a.context=y(a.container);a.data||(a.data={});a.data._pjax=k.selector;var l;a.beforeSend=function(b,d){"GET"!==d.type&&(d.timeout=0);b.setRequestHeader("X-PJAX","true");b.setRequestHeader("X-PJAX-Container",k.selector);if(!c("pjax:beforeSend",[b,d]))return!1;0<d.timeout&&(l=setTimeout(function(){c("pjax:timeout",
[b,a])&&b.abort("timeout")},d.timeout),d.timeout=0);a.requestUrl=t(d.url).href};a.complete=function(b,d){l&&clearTimeout(l);c("pjax:complete",[b,d,a]);c("pjax:end",[b,a])};a.error=function(b,d,e){var f=z("",b,a);b=c("pjax:error",[b,d,e,a]);"GET"==a.type&&("abort"!==d&&b)&&r(f.url)};a.success=function(e,h,l){var m="function"===typeof b.pjax.defaults.version?b.pjax.defaults.version():b.pjax.defaults.version,n=l.getResponseHeader("X-PJAX-Version"),g=z(e,l,a);m&&n&&m!==n?r(g.url):g.contents?(f.state=
{id:a.id||(new Date).getTime(),url:g.url,title:g.title,container:k.selector,fragment:a.fragment,timeout:a.timeout},(a.push||a.replace)&&window.history.replaceState(f.state,g.title,g.url),document.activeElement.blur(),g.title&&(document.title=g.title),k.html(g.contents),(m=k.find("input[autofocus], textarea[autofocus]").last()[0])&&document.activeElement!==m&&m.focus(),G(g.scripts),"number"===typeof a.scrollTo&&b(window).scrollTop(a.scrollTo),""!==d&&(m=t(g.url),m.hash=d,f.state.url=m.href,window.history.replaceState(f.state,
g.title,m.href),g=b(m.hash),g.length&&b(window).scrollTop(g.offset().top)),c("pjax:success",[e,h,l,a])):r(g.url)};f.state||(f.state={id:(new Date).getTime(),url:window.location.href,title:document.title,container:k.selector,fragment:a.fragment,timeout:a.timeout},window.history.replaceState(f.state,document.title));var h=f.xhr;h&&4>h.readyState&&(h.onreadystatechange=b.noop,h.abort());f.options=a;h=f.xhr=b.ajax(a);0<h.readyState&&(a.push&&!a.replace&&(H(f.state.id,k.clone().contents()),window.history.pushState(null,
"",A(a.requestUrl))),c("pjax:start",[h,a]),c("pjax:send",[h,a]));return f.xhr}function I(a,c){return f(b.extend({url:window.location.href,push:!1,replace:!0,scrollTo:!1},q(a,c)))}function r(a){window.history.replaceState(null,"","#");window.location.replace(a)}function B(a){if((a=a.state)&&a.container){if(u&&J==a.url||f.state.id===a.id)return;var c=b(a.container);if(c.length){var e,d=n[a.id];if(f.state){var k=e=f.state.id<a.id?"forward":"back",l=f.state.id,h=c.clone().contents();n[l]=h;"forward"===
k?(k=p,h=s):(k=s,h=p);k.push(l);(l=h.pop())&&delete n[l]}e=b.Event("pjax:popstate",{state:a,direction:e});c.trigger(e);e={id:a.id,url:a.url,container:c,push:!1,fragment:a.fragment,timeout:a.timeout,scrollTo:!1};d?(c.trigger("pjax:start",[null,e]),a.title&&(document.title=a.title),c.html(d),f.state=a,c.trigger("pjax:end",[null,e])):f(e);c[0].offsetHeight}else r(location.href)}u=!1}function K(a){var c=b.isFunction(a.url)?a.url():a.url,e=a.type?a.type.toUpperCase():"GET",d=b("<form>",{method:"GET"===
e?"GET":"POST",action:c,style:"display:none"});"GET"!==e&&"POST"!==e&&d.append(b("<input>",{type:"hidden",name:"_method",value:e.toLowerCase()}));a=a.data;if("string"===typeof a)b.each(a.split("&"),function(a,c){var e=c.split("=");d.append(b("<input>",{type:"hidden",name:e[0],value:e[1]}))});else if("object"===typeof a)for(key in a)d.append(b("<input>",{type:"hidden",name:key,value:a[key]}));b(document.body).append(d);d.submit()}function A(a){return a.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,
"").replace(/[\?&]$/,"")}function t(a){var b=document.createElement("a");b.href=a;return b}function q(a,c){a&&c?c.container=a:c=b.isPlainObject(a)?a:{container:a};c.container&&(c.container=y(c.container));return c}function y(a){a=b(a);if(a.length){if(""!==a.selector&&a.context===document)return a;if(a.attr("id"))return b("#"+a.attr("id"));throw"cant get selector for pjax container!";}throw"no pjax container for "+a.selector;}function v(a){return b.parseHTML(a,document,!0)}function z(a,c,e){var d=
{};d.url=A(c.getResponseHeader("X-PJAX-URL")||e.requestUrl);if(/<html/i.test(a)){c=b(v(a.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]));var f=b(v(a.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]))}else c=f=b(v(a));if(0===f.length)return d;d.title=c.filter("title").add(c.find("title")).last().text();e.fragment?(a="body"===e.fragment?f:f.filter(e.fragment).add(f.find(e.fragment)).first(),a.length&&(d.contents=a.contents(),d.title||(d.title=a.attr("title")||a.data("title")))):/<html/i.test(a)||(d.contents=
f);d.contents&&(d.contents=d.contents.not(function(){return b(this).is("title")}),d.contents.find("title").remove(),d.scripts=d.contents.filter("script[src]").add(d.contents.find("script[src]")).remove(),d.contents=d.contents.not(d.scripts));d.title&&(d.title=b.trim(d.title));return d}function G(a){if(a){var c=b("script[src]");a.each(function(){var a=this.src;if(!c.filter(function(){return this.src===a}).length){var d=document.createElement("script");d.type=b(this).attr("type");d.src=b(this).attr("src");
document.head.appendChild(d)}})}}function H(a,b){n[a]=b;for(p.push(a);s.length;)delete n[s.shift()];for(;p.length>f.defaults.maxCacheLength;)delete n[p.shift()]}function L(){return b("meta").filter(function(){var a=b(this).attr("http-equiv");return a&&"X-PJAX-VERSION"===a.toUpperCase()}).attr("content")}function C(){b.fn.pjax=E;b.pjax=f;b.pjax.enable=b.noop;b.pjax.disable=D;b.pjax.click=x;b.pjax.submit=F;b.pjax.reload=I;b.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,
maxCacheLength:20,version:L};b(window).on("popstate.pjax",B)}function D(){b.fn.pjax=function(){return this};b.pjax=K;b.pjax.enable=C;b.pjax.disable=b.noop;b.pjax.click=b.noop;b.pjax.submit=b.noop;b.pjax.reload=function(){window.location.reload()};b(window).off("popstate.pjax",B)}var u=!0,J=window.location.href,w=window.history.state;w&&w.container&&(f.state=w);"state"in window.history&&(u=!1);var n={},s=[],p=[];0>b.inArray("state",b.event.props)&&b.event.props.push("state");b.support.pjax=window.history&&
window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/);b.support.pjax?C():D()})(jQuery);
