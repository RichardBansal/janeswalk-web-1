!function e(t,a,n){function i(l,s){if(!a[l]){if(!t[l]){var r="function"==typeof require&&require;if(!s&&r)return r(l,!0);if(o)return o(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var d=a[l]={exports:{}};t[l][0].call(d.exports,function(e){var a=t[l][1][e];return i(a?a:e)},d,d.exports,e,t,a,n)}return a[l].exports}for(var o="function"==typeof require&&require,l=0;l<n.length;l++)i(n[l]);return i}({1:[function(e){PageViews={PageView:e("./v2/views/Page.jsx"),CityPageView:e("./v2/views/pages/City.jsx"),HomePageView:e("./v2/views/pages/Home.jsx"),ProfilePageView:e("./v2/views/pages/Profile.jsx"),WalkPageView:e("./v2/views/pages/Walk.jsx")},document.addEventListener("DOMContentLoaded",function(){var e=document.body.getAttribute("data-pageViewName")||"PageView";try{new PageViews[e]($(document.body))}catch(t){console.error("Error instantiating page view "+e+": "+t.stack)}var a=document.getElementById("ccm-toolbar");a&&window.addEventListener("keyup",function(e){if("INPUT"!==e.target.tagName)switch(e.preventDefault(),String(e.key||e.keyCode&&String.fromCharCode(e.keyCode)||e.char).toUpperCase()){case"M":a.style&&(a.style.zIndex=99999==a.style.zIndex?-1:99999)}})})},{"./v2/views/Page.jsx":5,"./v2/views/pages/City.jsx":6,"./v2/views/pages/Home.jsx":7,"./v2/views/pages/Profile.jsx":8,"./v2/views/pages/Walk.jsx":9}],2:[function(){if(Function.prototype.bind||(Function.prototype.bind=function(e){"use strict";if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),a=this,n=function(){},i=function(){return a.apply(this instanceof n&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,i.prototype=new n,i}),function(){"use strict";var e=Object.prototype,t=e.__defineGetter__,a=e.__defineSetter__,n=e.__lookupGetter__,i=e.__lookupSetter__,o=e.hasOwnProperty;t&&a&&n&&i&&(Object.defineProperty||(Object.defineProperty=function(e,l,s){if(arguments.length<3)throw new TypeError("Arguments not optional");if(l+="",o.call(s,"value")&&(!n.call(e,l)&&!i.call(e,l)&&(e[l]=s.value),o.call(s,"get")||o.call(s,"set")))throw new TypeError("Cannot specify an accessor and a value");if(!(s.writable&&s.enumerable&&s.configurable))throw new TypeError("This implementation of Object.defineProperty does not support false for configurable, enumerable, or writable.");return s.get&&t.call(e,l,s.get),s.set&&a.call(e,l,s.set),e}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(e,t){if(arguments.length<2)throw new TypeError("Arguments not optional.");t+="";var a={configurable:!0,enumerable:!0,writable:!0},l=n.call(e,t),s=i.call(e,t);return o.call(e,t)?l||s?(delete a.writable,a.get=a.set=void 0,l&&(a.get=l),s&&(a.set=s),a):(a.value=e[t],a):a}),Object.defineProperties||(Object.defineProperties=function(e,t){var a;for(a in t)o.call(t,a)&&Object.defineProperty(e,a,t[a])}))}(),!(document.documentElement.dataset||Object.getOwnPropertyDescriptor(Element.prototype,"dataset")&&Object.getOwnPropertyDescriptor(Element.prototype,"dataset").get)){var e={enumerable:!0,get:function(){"use strict";var e,t,a,n,i,o,l=this,s=this.attributes,r=s.length,c=function(e){return e.charAt(1).toUpperCase()},d=function(){return this},f=function(e,t){return"undefined"!=typeof t?this.setAttribute(e,t):this.removeAttribute(e)};try{({}).__defineGetter__("test",function(){}),t={}}catch(h){t=document.createElement("div")}for(e=0;r>e;e++)if(o=s[e],o&&o.name&&/^data-\w[\w\-]*$/.test(o.name)){a=o.value,n=o.name,i=n.substr(5).replace(/-./g,c);try{Object.defineProperty(t,i,{enumerable:this.enumerable,get:d.bind(a||""),set:f.bind(l,n)})}catch(u){t[i]=a}}return t}};try{Object.defineProperty(Element.prototype,"dataset",e)}catch(t){e.enumerable=!1,Object.defineProperty(Element.prototype,"dataset",e)}}Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t,a=Object(e),n=!1,i=1;i<arguments.length;i++){var o=arguments[i];if(void 0!==o&&null!==o){for(var l=Object.keys(Object(o)),s=0,r=l.length;r>s;s++){var c=l[s];try{var d=Object.getOwnPropertyDescriptor(o,c);void 0!==d&&d.enumerable&&(a[c]=o[c])}catch(f){n||(n=!0,t=f)}}if(n)throw t}}return a}})},{}],3:[function(e,t){e("../shims.js");var a=function(e){this._element=e};Object.defineProperties(a.prototype,{_element:{value:null,writable:!0,configurable:!0},getElement:{value:function(){return this._element}}}),t.exports=a},{"../shims.js":2}],4:[function(e,t){var a=function(e){this._shareObj=e,this._shareObj.method="feed"};a.prototype={_shareObj:null,show:function(e,t){FB.ui(this._shareObj,function(a){void 0!==a&&(null===a?e&&e():t&&t())})}},t.exports=a},{}],5:[function(e,t){var a=e("../View.jsx"),n=function(e){a.call(this,e),this._addNavEvents(),this._addOverlayCloseEvent()};n.prototype=Object.create(a.prototype,{_addOverlayCloseEvent:{value:function(){var e=this;this._element.find(".o-background").click(function(){e._element.find(".overlay").hide()}),this._element.find("a.closeModalCta").click(function(t){t.preventDefault(),e._element.find(".overlay").hide()})}},_addNavEvents:{value:function(){this._element.find("a.search-open").click(function(){$("html, body").animate({scrollTop:0},300),$("body > header").addClass("dropped")}),this._element.find("a.search-close").click(function(){$("body > header").removeClass("dropped")})}},_makeGaCall:{value:function(e){_gaq.push(e)}},trackCustomVar:{value:function(e,t,a,n){var i=["_setCustomVar",e,t,a,n];this._makeGaCall(i)}},trackEvent:{value:function(e,t,a,n,i){var o=["_trackEvent"];void 0!==e&&o.push(e),void 0!==t&&o.push(t),void 0!==a&&o.push(a),void 0!==n&&o.push(n),this._makeGaCall(o,i)}},trackView:{value:function(e){var t=["_trackPageview",e];this._makeGaCall(t)}}}),t.exports=n},{"../View.jsx":3}],6:[function(e,t){var a=e("../Page.jsx"),n=function(e){a.call(this,e),this._cards=this._element[0].querySelectorAll(".walk"),this._previewCards(),this._data=JanesWalk.walks,this._resetSelectElements(),this._addCreateWalkEvent(),this._addFilterEvents(),this._setThemeCounts(),this._captureHash(),this._addLinkListeners(),$(".walks-list .tag").tooltip()};n.prototype=Object.create(a.prototype,{_accessibility:{value:null,writable:!0},_cards:{value:null,writable:!0},_data:{value:null,writable:!0},_date:{value:null,writable:!0},_initiative:{value:null,writable:!0},_theme:{value:null,writable:!0},_ward:{value:null,writable:!0},_getFacebookDialogDonateObj:{value:function(){return{link:"http://janeswalk.org",name:"Jane's Walk"}}},_previewCards:{value:function(){for(var e=Array.prototype.slice.call(this._cards).sort(function(){return.5-Math.random()}),t=document.querySelector(".ccm-block-page-list-walk-filters .walk-preview"),a=0,n=Math.min(e.length,9);n>a;a++){var i=e[a].cloneNode(!0);t.appendChild(i)}}},_addLinkListeners:{value:function(){var e=document.querySelector("a.see-all");e&&e.addEventListener("click",function(){document.querySelector(".ccm-block-page-list-walk-filters").classList.add("filtering"),e.parentNode.removeChild(e)})}},_setupText2DonateInterstitials:{value:function(){var e,t,a,n,i=!1,o=this,l=null!==location.pathname.match(/\/canada\/[^/]+/);this._element.find("a.closeCatfishCta").click(function(e){e.preventDefault(),o._element.find(".catfish").hide(),jQuery.cookie("hasSeenDonateCatfish","1",{path:"/",domain:location.host})}),i&&l===!0&&(e=null!==jQuery.cookie("hasSeenDonateInterstitial")&&"undefined"!=typeof jQuery.cookie("hasSeenDonateInterstitial"),e===!1?(t=function(){jQuery.cookie("hasSeenDonateInterstitial","1",{path:"/",domain:location.host}),o._element.find(".catfish.c-donate").removeClass("hidden")},this._element.find(".overlay.o-donate").show(),this._element.find(".overlay.o-donate .o-background").click(t),this._element.find("a.closeModalCta").click(t),this._element.find("div.btnWrapper a").click(function(e){jQuery.cookie("hasSeenDonateInterstitial","1",{path:"/",domain:location.host}),jQuery.cookie("hasSeenDonateCatfish","1",{path:"/",domain:location.host}),e.preventDefault(),o._element.find(".o-donate").hide(),o._element.find(".o-shout").show(),o._element.find(".o-shout .icon-twitter").click(function(e){e.preventDefault(),a=encodeURIComponent("http://janeswalk.org/"),text=encodeURIComponent($(this).closest(".option").find(".copy").text().trim()),n="https://twitter.com/intent/tweet?url="+a+"&via=janeswalk&text="+text,window.open(n,"Twitter Share","width=640, height=320")}),o._element.find(".o-shout .icon-facebook").click(function(e){e.preventDefault();var t=o._getFacebookDialogDonateObj();t.description=$(this).closest(".option").find(".copy").text().trim(),new FacebookShareDialog(t).show()})})):(hasSeenDonateCatfish=null!==jQuery.cookie("hasSeenDonateCatfish")&&"undefined"!=typeof jQuery.cookie("hasSeenDonateCatfish"),hasSeenDonateCatfish===!1&&this._element.find(".catfish").removeClass("hidden")))}},_setThemeCounts:{value:function(){var e,t=this,a=Array.prototype.forEach,n=this._element[0],i=function(a){var n=a.getAttribute("value"),i=this.compare_fn||function(e,t){return e[t]};if("*"!==n){e=0;for(var o in t._data)i(t._data[o][this.filter],n)&&++e;a.textContent+=" ("+e+")",0===e&&a.parentElement.removeChild(a)}};a.call(n.querySelectorAll('div.filters select[name="theme"] option'),i,{filter:"themes"}),a.call(n.querySelectorAll('div.filters select[name="accessibility"] option'),i,{filter:"accessibilities"}),a.call(n.querySelectorAll('div.filters select[name="ward"] option'),i,{filter:"wards"}),a.call(n.querySelectorAll('div.filters select[name="initiative"] option'),i,{filter:"initiatives"}),a.call(n.querySelectorAll('div.filters select[name="date"] option'),i,{filter:"datetimes",compare_fn:function(e,t){for(var a=0;a<e.length;a++)return-1!==e[a].date.indexOf(t)}})}},_resetSelectElements:{value:function(){var e=this;this._element.find("div.filters select").each(function(e,t){$(t).val("*")}),this._element.find(".initiatives").addClass("hidden"),this._element.find(".initiative").addClass("hidden"),this._element.find("#initiative").change(function(){"#"!==$(this).val()&&(e._element.find(".initiatives").removeClass("hidden"),e._element.find('[data-jw-initiative="'+$(this).val()+'"]').removeClass("hidden"))})}},_addCreateWalkEvent:{value:function(){var e=this,t=this._element.find(".create-walk");t.click(function(t){t.preventDefault(),0===e._element.find('a[href="/index.php/login/logout/"]').length?e._element.find(".overlay.o-connect").show():location.href=$(this).attr("href")})}},_captureHash:{value:function(){var e=this;""!==location.hash&&(pieces=location.hash.replace("#","").split("&"),key="",$(pieces).each(function(t,a){key="_"+a.split("=")[0],e[key]=a.split("=")[1]}),this._filterCards(),this._element.find('select[name="ward"]').val(this._ward),this._element.find('select[name="theme"]').val(this._theme),this._element.find('select[name="accessibility"]').val(this._accessibility),this._element.find('select[name="initiative"]').val(this._initiative),this._element.find('select[name="date"]').val(this._date))}},_setHash:{value:function(){location.hash="ward="+this._ward+"&theme="+this._theme+"&accessibility="+this._accessibility+"&initiative="+this._initiative+"&date="+this._date}},_filterCards:{value:function(){for(var e=this,t=0,a=function(e,t){return"*"===e||t&&t[e]},n=0,i=this._cards.length;i>n;n++)this._cards[n].classList.add("hidden");this._data.forEach(function(i,o){a(e._ward,i.wards)&&a(e._theme,i.themes)&&a(e._accessibility,i.accessibilities)&&a(e._initiative,i.initiatives)&&function(e,t){if("*"===t)return!0;for(n=0;n<e.length;n++)return-1!==e[n].date.indexOf(t)}(i.datetimes,e._date)&&(++t,e._cards[o].classList.remove("hidden"))}),this._element.find(".empty").addClass("hidden"),0===t&&this._element.find(".empty").removeClass("hidden")}},_addFilterEvents:{value:function(){var e=this;this._element.find("div.filters select").change(function(t){t.preventDefault(),e._ward="*",e._element.find('select[name="ward"]').length>0&&(e._ward=e._element.find('select[name="ward"]').val()),e._theme="*",e._element.find('select[name="theme"]').length>0&&(e._theme=e._element.find('select[name="theme"]').val()),e._accessibility="*",e._element.find('select[name="accessibility"]').length>0&&(e._accessibility=e._element.find('select[name="accessibility"]').val()),e._initiative="*",e._element.find('select[name="initiative"]').length>0&&(e._initiative=e._element.find('select[name="initiative"]').val()),e._date="*",e._element.find('select[name="date"]').length>0&&(e._date=e._element.find('select[name="date"]').val()),e._setHash(),e._filterCards()})}}}),t.exports=n},{"../Page.jsx":5}],7:[function(e,t){var a=e("../Page.jsx"),n=function(e){a.call(this,e),this._addMapToggleEvents(),this._addBgImage(),this._addCityDropdownEvent(),this._addCreateWalkEvent()};n.prototype=Object.create(a.prototype,{_addCreateWalkEvent:{value:function(){var e=this,t=this._element.find('.calltoaction li a[href="/walk/form/"]');t.click(function(t){t.preventDefault(),e._element.find('a[href="/index.php/login/logout/"]').length?location.href=$(this).attr("href"):e._element.find(".overlay").show()})}},_addCityDropdownEvent:{value:function(){var e=this._element.find("select.pageListSelect");e.change(function(){location.href=e.val()})}},_addBgImage:{value:function(){var e=this._element.attr("data-backgroundImageUrl"),t=this._element.find(".backgroundImageBanner"),a=document.createElement("img");a.onload=function(){t.css({backgroundImage:"url("+e+")"}),t.removeClass("faded")},a.src=e}},_addCityButtonCta:{value:function(e,t){React.render(this._element.find(".calltoaction ul").first(),React.createElement("li",{className:"cityButtonCta"},React.createElement("a",{href:t,className:"btn btn-primary"},"View walks in ",e)))}},_addMapToggleEvents:{value:function(){var e=this._element.find(".overlap .controls a.showButton"),t=this._element.find(".overlap .controls a.closeButton");e.click(function(){$(".overlap").addClass("fullmap"),$(this).fadeOut(400,function(){t.fadeIn()}),$("html, body").animate({scrollTop:$(this).offset().top-100},800)}),t.click(function(){$(".overlap").removeClass("fullmap"),$(this).fadeOut(400,function(){e.fadeIn()})})}}}),t.exports=n},{"../Page.jsx":5}],8:[function(e,t){var a=e("../Page.jsx"),n=function(e){try{a.call(this,e),this._showProperStep(),this._addTabClickEvents(),this._setupDisplayPictureFlashWidget(),this._addPictureDeleteEvent(),this._addPromoteWalkClickEvent(),this._addPromoteCityClickEvent(),this._addPromoteBlogPostClickEvent(),this._setupCityPromoteModalEvents(),this._setupWalkPromoteModalEvents(),this._setupBlogPostPromoteModalEvents(),this._setupPromoteSlideshows(),this._setupTransferWalkEvents()}catch(t){console.error("Error initializing profile: "+t.stack)}};n.prototype=Object.create(a.prototype,{_slideIndexes:{value:{blogPost:0,city:0,walk:0},writable:!0},_currentTab:{value:null,writable:!0},_addPictureDeleteEvent:{value:function(){this._element.find('a[href="/index.php/profile/delete/"]').click(function(e){e.preventDefault(),$.ajax({type:"DELETE",url:$(this).attr("href"),success:function(){location.href="/index.php/profile/#tab=picture&success=1"}})})}},_addPromoteBlogPostClickEvent:{value:function(){var e=this,t=this._element.find(".column.blogPosts .subactions .promote");t.click(function(t){t.preventDefault();var a=e._getBlogPostObjById($(this).data("blogpostid"));e._element.find(".blogPostPromoteOverlay .copy").each(function(e,t){var n=$(t);n.data("blogpostpath",a.path),n.find(".objTitle").text(a.title)}),e._element.find(".blogPostPromoteOverlay").show()})}},_addPromoteCityClickEvent:{value:function(){var e=this,t=this._element.find("#cityBlock .promoteBtn");t.click(function(t){t.preventDefault(),e._element.find(".cityPromoteOverlay").show()})}},_getBlogPostObjById:{value:function(e){var t=this._element.find('[data-blogpostid="'+e+'"]');return{title:t.first().data("blogposttitle"),path:t.first().data("blogpostpath")}}},_getWalkObjById:{value:function(e){var t=this._element.find('[data-walkid="'+e+'"]');return{title:t.first().data("walktitle"),path:t.first().data("walkpath")}}},_addPromoteWalkClickEvent:{value:function(){var e=this,t=this._element.find(".column.city .subactions .promote,.column.walks .subactions .promote");t.click(function(t){t.preventDefault();var a=e._getWalkObjById($(this).data("walkid"));e._element.find(".walkPromoteOverlay .copy").each(function(e,t){var n=$(t);n.data("walkpath",a.path),n.find(".objTitle").text(a.title)}),e._element.find(".walkPromoteOverlay").show()})}},_addTabClickEvents:{value:function(){var e=this;this._element.find("ul.nav-tabs li a").click(function(t){t.preventDefault(),e._currentTab=$(this).attr("data-tab"),e._showCurrentTab()}),this._element.find(".tabLink").click(function(t){t.preventDefault(),e._currentTab=$(this).attr("data-tab"),e._showCurrentTab()})}},_setupBlogPostPromoteModalEvents:{value:function(){var e=this;this._element.find(".blogPostPromoteOverlay").find(".icon-twitter").click(function(t){t.preventDefault();var a=$(this).closest(".option").find(".copy");e._showTwitterShareWindow("http://janeswalk.org"+a.data("blogpostpath"),a.text().trim())}),this._element.find(".blogPostPromoteOverlay").find(".icon-facebook").click(function(t){t.preventDefault();var a=$(this).closest(".option").find(".copy");e._showFacebookShareWindow("http://janeswalk.org"+a.data("blogpostpath"),"Jane's Walk",a.text().trim())}),this._element.find(".blogPostPromoteOverlay").find(".icon-envelope").click(function(t){t.preventDefault();var a=$(this).closest(".option").find(".copy");e._showEmailShareWindow("Jane's Walk in "+e._element.find("#profileWrapper").data("city"),a.text().trim())})}},_setupCityPromoteModalEvents:{value:function(){var e=this._element.find(".cityPromoteOverlay").data("citypath"),t=this._element.find(".cityPromoteOverlay").data("cityname"),a=this;this._element.find(".cityPromoteOverlay").find(".icon-twitter").click(function(t){t.preventDefault(),a._showTwitterShareWindow("http://janeswalk.org"+e,$(this).closest(".option").find(".copy").text().trim())}),this._element.find(".cityPromoteOverlay").find(".icon-facebook").click(function(t){t.preventDefault(),a._showFacebookShareWindow("http://janeswalk.org"+e,"Jane's Walk",$(this).closest(".option").find(".copy").text().trim())}),this._element.find(".cityPromoteOverlay").find(".icon-envelope").click(function(e){e.preventDefault(),a._showEmailShareWindow("Jane's Walk in "+t,$(this).closest(".option").find(".copy").text().trim())})}},_setupTransferWalkEvents:{value:function(){var e=this;this._element.find("#walk-transfer .users a").click(function(e){e.preventDefault(),$.get(this.getAttribute("href"),function(e){e.error?alert(e.error):window.location=window.location})}),this._element.find("a.transfer").removeClass("hidden").click(function(t){t.preventDefault();for(var a=e._element.find("#walk-transfer"),n=this.getAttribute("href"),i=a.find(".users a"),o=0,l=i.length;l>o;o++)i[o].setAttribute("href",n+"transfer/"+i[o].getAttribute("data-uid"));a.modal()})}},_setupDisplayPictureFlashWidget:{value:function(){window.ThumbnailBuilder_onSaveCompleted=function(){location.href="/index.php/profile/#tab=picture&success=1"};var e={bgcolor:"#ffffff",wmode:"transparent",quality:"high"},t={width:this._element.find("#flashContainer").attr("data-width"),height:this._element.find("#flashContainer").attr("data-height"),image:this._element.find("#flashContainer").attr("data-imagepath"),save:this._element.find("#flashContainer").attr("data-savepath")};"undefined"!=typeof swfobject&&swfobject.embedSWF(this._element.find("#flashContainer").attr("data-flashpath"),"flashContainer","500","400","10,0,0,0","includes/expressInstall.swf",t,e)}},_showSlide:{value:function(e){var t=this._slideIndexes[e],a=this._element.find('[data-slideshow="'+e+'"]'),n=a.find(".options .option");n.addClass("hidden"),$(n[t]).removeClass("hidden")}},_setupPromoteSlideshows:{value:function(){var e=this;this._element.find(".promoteOverlay .nav > a.left").click(function(t){t.preventDefault();{var a=$(this),n=a.data("slideshow"),i=a.closest(".promoteOverlay"),o=i.find(".options .option").length;i.find(".options .option")}0===e._slideIndexes[n]?e._slideIndexes[n]=o-1:--e._slideIndexes[n],e._showSlide(n)}),this._element.find(".promoteOverlay .nav > a.right").click(function(t){t.preventDefault();{var a=$(this),n=a.data("slideshow"),i=a.closest(".promoteOverlay"),o=i.find(".options .option").length;i.find(".options .option")}e._slideIndexes[n]===o-1?e._slideIndexes[n]=0:++e._slideIndexes[n],e._showSlide(n)})}},_setupWalkPromoteModalEvents:{value:function(){var e=this;this._element.find(".walkPromoteOverlay").find(".icon-twitter").click(function(t){t.preventDefault();var a=$(this).closest(".option").find(".copy");e._showTwitterShareWindow("http://janeswalk.org"+a.data("walkpath"),a.text().trim())}),this._element.find(".walkPromoteOverlay").find(".icon-facebook").click(function(t){t.preventDefault();var a=$(this).closest(".option").find(".copy");e._showFacebookShareWindow("http://janeswalk.org"+a.data("walkpath"),"Jane's Walk",a.text().trim())}),this._element.find(".walkPromoteOverlay").find(".icon-envelope").click(function(t){t.preventDefault();var a=$(this).closest(".option").find(".copy");e._showEmailShareWindow("Jane's Walk in "+e._element.find("#profileWrapper").data("city"),a.text().trim())})}},_showCurrentTab:{value:function(){this._element.find("ul.nav-tabs li.active").removeClass("active"),this._element.find('ul.nav-tabs li a[data-tab="'+this._currentTab+'"]').parent().addClass("active"),this._element.find("div.content div.block").addClass("hidden"),this._element.find('div.content div.block[data-tab="'+this._currentTab+'"]').removeClass("hidden"),location.hash="tab="+this._currentTab}},_showEmailShareWindow:{value:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t);var a="mailto:?subject="+e+"&body="+t;window.open(a)}},_showFacebookShareWindow:{value:function(e,t,a){new FacebookShareDialog({link:e,name:t,description:a}).show()}},_showProperStep:{value:function(){if(""!==location.hash){var e,t=location.hash.split("&"),a={};$(t).each(function(t,n){e=n.split("="),a[e[0].replace("#","")]=e[1]}),this._currentTab=a.tab,this._showCurrentTab(),"undefined"!=typeof a.success&&1===parseInt(a.success)&&this._element.find('div.content div.block[data-tab="'+this._currentTab+'"]').addClass("success")}}},_showTwitterShareWindow:{value:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t),t.length>130&&(t=t.substring(0,130)+"..."),e="https://twitter.com/intent/tweet?url="+e+"&via=janeswalk&text="+t,window.open(e,"Twitter Share","width=640, height=320")}}}),t.exports=n},{"../Page.jsx":5}],9:[function(e,t){var a=e("../Page.jsx"),n=e("../FacebookShareDialog.jsx"),i=function(e){a.call(this,e),this._addFacebookDialogEvents(),document.getElementById("map-canvas")&&this._initializeMap()};i.prototype=Object.create(a.prototype,{_styledMap:{value:new google.maps.StyledMapType([{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{visibility:"on"},{saturation:-100}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{saturation:-100}]},{featureType:"landscape.natural",stylers:[{saturation:-100},{lightness:36}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{visibility:"on"},{saturation:37}]},{featureType:"landscape.man_made",stylers:[{saturation:-100}]}],{name:"Styled Map"}),writable:!1,enumerable:!0},_addFacebookDialogEvents:{value:function(){var e=this;this._element.find(".facebookShareLink").click(function(t){t.preventDefault(),e.trackEvent("Walk","share.attempted","facebook");var a=e._getFacebookDialogObj();new n(a).show(e._facebookShareFailed,e._facebookShareSuccessful)})}},_facebookShareFailed:{value:function(){this.trackEvent("Walk","share.failed","facebook")}},_facebookShareSuccessful:{value:function(){this.trackEvent("Walk","share.successful","facebook")}},_getFacebookDialogObj:{value:function(){return{link:JanesWalk.page.url,picture:JanesWalk.page.pictureUrl,name:JanesWalk.page.title,description:JanesWalk.page.description,actions:{name:"View Jane's Walks in "+JanesWalk.page.city.name,link:JanesWalk.page.city.url}}}},_initializeMap:{value:function(){var e,t,a,n,i=[],o="undefined"==typeof zoomLevelset?16:zoomLevelset,l={zoom:o,scrollwheel:!1,zoomControl:!0,disableDefaultUI:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},s=new google.maps.Map(document.getElementById("map-canvas"),l),r=[],c=CCM_THEME_PATH+"/images/marker.png",d=new google.maps.InfoWindow({maxWidth:300}),f=new InfoBox({content:document.getElementById("infobox"),maxWidth:150,pixelOffset:new google.maps.Size(-3,-25),alignBottom:!0,boxStyle:{background:"#fff",width:"280px",padding:"10px",border:"1px solid #eee"},closeBoxMargin:"-22px -22px 2px -8px",closeBoxURL:CCM_THEME_PATH+"/images/map-close.png",infoBoxClearance:new google.maps.Size(20,20)}),h=function(e,t,a){return function(){for(var n=0;n<i.length;n++)i[n].setIcon(p);s.panTo(e.getPosition()),this.setIcon(u),f.setContent(React.renderToStaticMarkup(React.createElement("span",null,React.createElement("h4",null,JanesWalk.page.gmap.markers[t].title),React.createElement("p",null,JanesWalk.page.gmap.markers[t].description),a))),f.open(s,e),$(".walk-stop").removeClass("active"),$(".walk-stops-meta #"+t).addClass("active")}},u=new google.maps.MarkerImage(CCM_THEME_PATH+"/images/marker-active.png"),p=new google.maps.MarkerImage(CCM_THEME_PATH+"/images/marker.png");for(t in JanesWalk.page.gmap.route)r.push(new google.maps.LatLng(JanesWalk.page.gmap.route[t].lat,JanesWalk.page.gmap.route[t].lng));e=new google.maps.Polyline({path:r,strokeColor:"#F16725",strokeOpacity:.8,strokeWeight:4}),e.setMap(s),s.mapTypes.set("map_style",this._styledMap),s.setMapTypeId("map_style");for(var m in JanesWalk.page.gmap.markers)marker=new google.maps.Marker({position:new google.maps.LatLng(JanesWalk.page.gmap.markers[m].lat,JanesWalk.page.gmap.markers[m].lng),map:s,icon:c,id:m}),i.push(marker),n="",$("body").hasClass("create-page")&&(n=React.createElement("button",{className:"btn pull-right",id:"delete-marker"},React.createElement("i",{className:"fa fa-trash"}))),google.maps.event.addListener(marker,"click",h(marker,m,n));$(".walk-stops").show();var v=new google.maps.LatLngBounds;for(a in i)v.extend(i[a].getPosition());for(a in e.getPath().getArray())v.extend(e.getPath().getAt(a));i.length>0&&s.fitBounds(v),google.maps.event.addListenerOnce(s,"zoom_changed",function(){var e=s.getZoom();s.setZoom(Math.min(16,e))}),google.maps.event.addDomListener(document.getElementById("map-canvas"),"touchstart",function(){s.setOptions({panControl:!1,draggable:!1})}),google.maps.event.addListener(marker,"dragend",function(){var e=marker.getPosition();s.panTo(e),document.getElementById("txt_latlng").value=e.lat()+", "+e.lng()}),google.maps.event.addListenerOnce(d,"domready",function(){google.maps.event.addDomListener(document.getElementById("save-marker"),"click",function(){d.close(s,marker)})}),$(".walk-stop").on("click",function(){marker=i[this.id],$(".walk-stop").removeClass("active"),$(this).addClass("active"),google.maps.event.trigger(marker,"click")})}}}),t.exports=i},{"../FacebookShareDialog.jsx":4,"../Page.jsx":5}]},{},[1]);