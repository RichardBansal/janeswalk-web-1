/*! janeswalk 2014-07-30 */
function toStandardTime(a){timeArray=a.split(":");var b,c;return 12==timeArray[0]?(b=12,c="pm"):timeArray[0]>12?(b=timeArray[0]-12,c="pm"):(b=timeArray[0],c="am"),b=b+":"+timeArray[1]+c}function blurPage(){$("body > section, body > header").addClass("blur")}function unblurPage(){$("body > section, body > header").removeClass("blur")}!function(){var a=!1,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype,f=function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}};a=!0;var g=new this;a=!1;for(var h in c)g[h]="function"==typeof c[h]&&"function"==typeof e[h]&&b.test(c[h])?f(h,c[h]):c[h];return d.prototype=g,d.prototype.constructor=d,d.extend=arguments.callee,d}}();var FacebookShareDialog=Class.extend({_shareObj:null,init:function(a){this._shareObj=a,this._shareObj.method="feed"},show:function(a,b){FB.ui(this._shareObj,function(c){"undefined"!=typeof c&&(null===c?a&&a():b&&b())})}}),View=Class.extend({_element:null,init:function(a){this._element=a},getElement:function(){return this._element}}),ModalView=View.extend({init:function(a){this._super(a),this._addCloseEvents()},_addCloseEvents:function(){var a=this;this._element.find(".closeModalSource").click(function(b){b.preventDefault(),a.close()})}}),PageView=View.extend({init:function(a){this._super(a),this._addNavEvents(),this._addOverlayCloseEvent()},_addOverlayCloseEvent:function(){var a=this;this._element.find(".o-background").click(function(){a._element.find(".overlay").hide()}),this._element.find("a.closeModalCta").click(function(b){b.preventDefault(),a._element.find(".overlay").hide()})},_addNavEvents:function(){this._element.find("a.search-open").click(function(){$("html, body").animate({scrollTop:0},300),$("header.navbar").addClass("dropped")}),this._element.find("a.search-close").click(function(){$("header.navbar").removeClass("dropped")})},_makeGaCall:function(a){_gaq.push(a)},trackCustomVar:function(a,b,c,d){var e=["_setCustomVar",a,b,c,d];this._makeGaCall(e)},trackEvent:function(a,b,c,d,e){var f=["_trackEvent"];"undefined"!=typeof a&&f.push(a),"undefined"!=typeof b&&f.push(b),"undefined"!=typeof c&&f.push(c),"undefined"!=typeof d&&f.push(d),this._makeGaCall(f,e)},trackView:function(a){var b=["_trackPageview",a];this._makeGaCall(b)}}),CityPageView=PageView.extend({_accessibility:null,_cards:null,_data:null,_date:null,_initiative:null,_theme:null,_ward:null,init:function(a){this._super(a),this._cards=this._element[0].querySelectorAll(".walk"),this._previewCards(),this._data=JanesWalk.walks,this._resetSelectElements(),this._addCreateWalkEvent(),this._addFilterEvents(),this._setThemeCounts(),this._captureHash(),this._addLinkListeners()},_getFacebookDialogDonateObj:function(){return{link:"http://janeswalk.org",name:"Jane's Walk"}},_previewCards:function(){for(var a=Array.prototype.slice.call(this._cards).sort(function(){return.5-Math.random()}),b=document.querySelector(".walks-list.preview div"),c=0,d=Math.min(a.length,9);d>c;c++){var e=a[c].cloneNode(!0);e.classList.add("col-md-4"),e.classList.remove("col-md-3"),b.appendChild(e)}},_addLinkListeners:function(){var a=document.querySelector("a.see-all");a&&a.addEventListener("click",function(){var a=[this,document.querySelector(".walk-preview.action-items"),document.querySelector(".walks-list.preview")],b=document.querySelector(".walks-list.showall");a.forEach(function(a){try{a.classList.remove("in")}catch(b){console.log("Error fading out menu: "+b)}}),a.forEach(function(a){a.style.width=0,a.style.padding=0,a.style.margin=0}),setTimeout(function(){a.forEach(function(a){a.style.display="none"}),b.classList.remove("hide"),b.classList.add("in")},300)})},_setupText2DonateInterstitials:function(){var a,b,c,d,e=!1,f=this,g=null!==location.pathname.match(/\/canada\/[^/]+/);this._element.find("a.closeCatfishCta").click(function(a){a.preventDefault(),f._element.find(".catfish").hide(),jQuery.cookie("hasSeenDonateCatfish","1",{path:"/",domain:location.host})}),e&&g===!0&&(a=null!==jQuery.cookie("hasSeenDonateInterstitial")&&"undefined"!=typeof jQuery.cookie("hasSeenDonateInterstitial"),a===!1?(b=function(){jQuery.cookie("hasSeenDonateInterstitial","1",{path:"/",domain:location.host}),f._element.find(".catfish.c-donate").removeClass("hidden")},this._element.find(".overlay.o-donate").show(),this._element.find(".overlay.o-donate .o-background").click(b),this._element.find("a.closeModalCta").click(b),this._element.find("div.btnWrapper a").click(function(a){jQuery.cookie("hasSeenDonateInterstitial","1",{path:"/",domain:location.host}),jQuery.cookie("hasSeenDonateCatfish","1",{path:"/",domain:location.host}),a.preventDefault(),f._element.find(".o-donate").hide(),f._element.find(".o-shout").show(),f._element.find(".o-shout .icon-twitter").click(function(a){a.preventDefault(),c=encodeURIComponent("http://janeswalk.org/"),text=encodeURIComponent($(this).closest(".option").find(".copy").text().trim()),d="https://twitter.com/intent/tweet?url="+c+"&via=janeswalk&text="+text,window.open(d,"Twitter Share","width=640, height=320")}),f._element.find(".o-shout .icon-facebook").click(function(a){a.preventDefault();var b=f._getFacebookDialogDonateObj();b.description=$(this).closest(".option").find(".copy").text().trim(),new FacebookShareDialog(b).show()})})):(hasSeenDonateCatfish=null!==jQuery.cookie("hasSeenDonateCatfish")&&"undefined"!=typeof jQuery.cookie("hasSeenDonateCatfish"),hasSeenDonateCatfish===!1&&this._element.find(".catfish").removeClass("hidden")))},_setThemeCounts:function(){var a,b=this,c=Array.prototype.forEach,d=this._element[0],e=function(c){var d=c.getAttribute("value"),e=this.compare_fn||function(a,b){return a[b]};if("*"!==d){a=0;for(var f in b._data)e(b._data[f][this.filter],d)&&++a;c.textContent+=" ("+a+")",0===a&&c.parentElement.removeChild(c)}};c.call(d.querySelectorAll('div.filters select[name="theme"] option'),e,{filter:"themes"}),c.call(d.querySelectorAll('div.filters select[name="accessibility"] option'),e,{filter:"accessibilities"}),c.call(d.querySelectorAll('div.filters select[name="ward"] option'),e,{filter:"wards"}),c.call(d.querySelectorAll('div.filters select[name="initiative"] option'),e,{filter:"initiatives"}),c.call(d.querySelectorAll('div.filters select[name="date"] option'),e,{filter:"datetimes",compare_fn:function(a,b){for(var c=0;c<a.length;c++)return-1!==a[c].date.indexOf(b)}})},_resetSelectElements:function(){var a=this;this._element.find("div.filters select").each(function(a,b){$(b).val("*")}),this._element.find(".initiatives").addClass("hidden"),this._element.find(".initiative").addClass("hidden"),this._element.find("#initiative").change(function(){"#"!==$(this).val()&&(a._element.find(".initiatives").removeClass("hidden"),a._element.find('[data-jw-initiative="'+$(this).val()+'"]').removeClass("hidden"))})},_addCreateWalkEvent:function(){var a=this,b=this._element.find(".create-walk");b.click(function(b){b.preventDefault(),0===a._element.find('a[href="/index.php/login/logout/"]').length?a._element.find(".overlay.o-connect").show():location.href=$(this).attr("href")})},_captureHash:function(){var a=this;""!==location.hash&&(pieces=location.hash.replace("#","").split("&"),key="",$(pieces).each(function(b,c){key="_"+c.split("=")[0],a[key]=c.split("=")[1]}),this._filterCards(),this._element.find('select[name="ward"]').val(this._ward),this._element.find('select[name="theme"]').val(this._theme),this._element.find('select[name="accessibility"]').val(this._accessibility),this._element.find('select[name="initiative"]').val(this._initiative),this._element.find('select[name="date"]').val(this._date))},_setHash:function(){location.hash="ward="+this._ward+"&theme="+this._theme+"&accessibility="+this._accessibility+"&initiative="+this._initiative+"&date="+this._date},_filterCards:function(){var a,b,c=this,d=0,e=function(a,b){return"*"===a||b&&b[a]};for(a=0,b=this._cards.length;b>a;a++)this._cards[a].classList.add("hidden");this._data.forEach(function(b,f){e(c._ward,b.wards)&&e(c._theme,b.themes)&&e(c._accessibility,b.accessibilities)&&e(c._initiative,b.initiatives)&&function(b,c){if("*"===c)return!0;for(a=0;a<b.length;a++)return-1!==b[a].date.indexOf(c)}(b.datetimes,c._date)&&(++d,c._cards[f].classList.remove("hidden"))}),this._element.find(".empty").addClass("hidden"),0===d&&this._element.find(".empty").removeClass("hidden")},_addFilterEvents:function(){var a=this;this._element.find("div.filters select").change(function(b){b.preventDefault(),a._ward="*",a._element.find('select[name="ward"]').length>0&&(a._ward=a._element.find('select[name="ward"]').val()),a._theme="*",a._element.find('select[name="theme"]').length>0&&(a._theme=a._element.find('select[name="theme"]').val()),a._accessibility="*",a._element.find('select[name="accessibility"]').length>0&&(a._accessibility=a._element.find('select[name="accessibility"]').val()),a._initiative="*",a._element.find('select[name="initiative"]').length>0&&(a._initiative=a._element.find('select[name="initiative"]').val()),a._date="*",a._element.find('select[name="date"]').length>0&&(a._date=a._element.find('select[name="date"]').val()),a._setHash(),a._filterCards()})}}),HomePageView=PageView.extend({init:function(a){this._super(a),this._addMapToggleEvents(),this._addCityLookup(),this._addBgImage(),this._addCityDropdownEvent(),this._addCreateWalkEvent()},_addCreateWalkEvent:function(){var a=this,b=this._element.find('.calltoaction li a[href="/walk/form/"]');b.click(function(b){b.preventDefault(),a._element.find('a[href="/index.php/login/logout/"]').length?location.href=$(this).attr("href"):a._element.find(".overlay").show()})},_addCityDropdownEvent:function(){var a=this._element.find("select.pageListSelect");a.change(function(){location.href=a.val()})},_addBgImage:function(){var a=this._element.attr("data-backgroundImageUrl"),b=this._element.find(".backgroundImageBanner"),c=document.createElement("img");c.onload=function(){b.css({backgroundImage:"url("+a+")"}),b.removeClass("faded")},c.src=a},_addCityCalloutCta:function(a,b){var c=this._element.find(".ccm-page-list-typeahead").first(),d=$("<h3 />"),e=$("<a />");e.attr({href:b}),e.text(a),d.append("See walks in ").append(e).append(", or:"),c.prepend(d)},_addCityButtonCta:function(a,b){var c=this._element.find(".calltoaction ul").first(),d=$("<li />"),e=$("<a />");d.attr({"class":"cityButtonCta"}),e.attr({"class":"btn btn-primary",href:b}),d.append(e),e.text("View walks in "+a),c.prepend(d)},_addCityLookup:function(){var a=this;window.freeGeoIpCallback=function(b){if("undefined"!=typeof b){var c=a._element.find("div.ccm-page-list-typeahead ul li a");c.each(function(c,d){$(d).text()===b.city&&(a._addCityCalloutCta(b.city,$(d).attr("href")),a._addCityButtonCta(b.city,$(d).attr("href")))})}},"undefined"==typeof JanesWalk.user||"undefined"==typeof JanesWalk.user.city?$.getScript("http://freegeoip.net/json/?callback=freeGeoIpCallback"):(a._addCityCalloutCta(JanesWalk.user.city.name,JanesWalk.user.city.url),a._addCityButtonCta(JanesWalk.user.city.name,JanesWalk.user.city.url))},_addMapToggleEvents:function(){var a=this._element.find(".overlap .controls a.showButton"),b=this._element.find(".overlap .controls a.closeButton");a.click(function(){$(".overlap").addClass("fullmap"),$(this).fadeOut(400,function(){b.fadeIn()}),$("html, body").animate({scrollTop:$(this).offset().top-100},800)}),b.click(function(){$(".overlap").removeClass("fullmap"),$(this).fadeOut(400,function(){a.fadeIn()})})}}),ProfilePageView=PageView.extend({_slideIndexes:{blogPost:0,city:0,walk:0},_currentTab:null,init:function(a){try{this._super(a),this._showProperStep(),this._addTabClickEvents(),this._setupDisplayPictureFlashWidget(),this._addPictureDeleteEvent(),this._addPromoteWalkClickEvent(),this._addPromoteCityClickEvent(),this._addPromoteBlogPostClickEvent(),this._setupCityPromoteModalEvents(),this._setupWalkPromoteModalEvents(),this._setupBlogPostPromoteModalEvents(),this._setupPromoteSlideshows()}catch(b){console.log("Error initializing profile: "+b)}},_addPictureDeleteEvent:function(){this._element.find('a[href="/index.php/profile/delete/"]').click(function(a){a.preventDefault(),$.ajax({type:"DELETE",url:$(this).attr("href"),success:function(){location.href="/index.php/profile/#tab=picture&success=1"}})})},_addPromoteBlogPostClickEvent:function(){var a=this,b=this._element.find(".column.blogPosts .subactions .promote");b.click(function(b){b.preventDefault();var c=a._getBlogPostObjById($(this).data("blogpostid"));a._element.find(".blogPostPromoteOverlay .copy").each(function(a,b){var d=$(b);d.data("blogpostpath",c.path),d.find(".objTitle").text(c.title)}),a._element.find(".blogPostPromoteOverlay").show()})},_addPromoteCityClickEvent:function(){var a=this,b=this._element.find("#cityBlock .promoteBtn");b.click(function(b){b.preventDefault(),a._element.find(".cityPromoteOverlay").show()})},_getBlogPostObjById:function(a){var b=this._element.find('[data-blogpostid="'+a+'"]');return{title:b.first().data("blogposttitle"),path:b.first().data("blogpostpath")}},_getWalkObjById:function(a){var b=this._element.find('[data-walkid="'+a+'"]');return{title:b.first().data("walktitle"),path:b.first().data("walkpath")}},_addPromoteWalkClickEvent:function(){var a=this,b=this._element.find(".column.city .subactions .promote,.column.walks .subactions .promote");b.click(function(b){b.preventDefault();var c=a._getWalkObjById($(this).data("walkid"));a._element.find(".walkPromoteOverlay .copy").each(function(a,b){var d=$(b);d.data("walkpath",c.path),d.find(".objTitle").text(c.title)}),a._element.find(".walkPromoteOverlay").show()})},_addTabClickEvents:function(){var a=this;this._element.find("ul.nav-tabs li a").click(function(b){b.preventDefault(),a._currentTab=$(this).attr("data-tab"),a._showCurrentTab()}),this._element.find(".tabLink").click(function(b){b.preventDefault(),a._currentTab=$(this).attr("data-tab"),a._showCurrentTab()})},_setupBlogPostPromoteModalEvents:function(){var a=this;this._element.find(".blogPostPromoteOverlay").find(".icon-twitter").click(function(b){b.preventDefault();var c=$(this).closest(".option").find(".copy");a._showTwitterShareWindow("http://janeswalk.org"+c.data("blogpostpath"),c.text().trim())}),this._element.find(".blogPostPromoteOverlay").find(".icon-facebook").click(function(b){b.preventDefault();var c=$(this).closest(".option").find(".copy");a._showFacebookShareWindow("http://janeswalk.org"+c.data("blogpostpath"),"Jane's Walk",c.text().trim())}),this._element.find(".blogPostPromoteOverlay").find(".icon-envelope").click(function(b){b.preventDefault();var c=$(this).closest(".option").find(".copy");a._showEmailShareWindow("Jane's Walk in "+a._element.find("#profileWrapper").data("city"),c.text().trim())})},_setupCityPromoteModalEvents:function(){var a=this._element.find(".cityPromoteOverlay").data("citypath"),b=this._element.find(".cityPromoteOverlay").data("cityname"),c=this;this._element.find(".cityPromoteOverlay").find(".icon-twitter").click(function(b){b.preventDefault(),c._showTwitterShareWindow("http://janeswalk.org"+a,$(this).closest(".option").find(".copy").text().trim())}),this._element.find(".cityPromoteOverlay").find(".icon-facebook").click(function(b){b.preventDefault(),c._showFacebookShareWindow("http://janeswalk.org"+a,"Jane's Walk",$(this).closest(".option").find(".copy").text().trim())}),this._element.find(".cityPromoteOverlay").find(".icon-envelope").click(function(a){a.preventDefault(),c._showEmailShareWindow("Jane's Walk in "+b,$(this).closest(".option").find(".copy").text().trim())})},_setupDisplayPictureFlashWidget:function(){window.ThumbnailBuilder_onSaveCompleted=function(){location.href="/index.php/profile/#tab=picture&success=1"};var a={bgcolor:"#ffffff",wmode:"transparent",quality:"high"},b={width:this._element.find("#flashContainer").attr("data-width"),height:this._element.find("#flashContainer").attr("data-height"),image:this._element.find("#flashContainer").attr("data-imagepath"),save:this._element.find("#flashContainer").attr("data-savepath")};"undefined"!=typeof swfobject&&swfobject.embedSWF(this._element.find("#flashContainer").attr("data-flashpath"),"flashContainer","500","400","10,0,0,0","includes/expressInstall.swf",b,a)},_showSlide:function(a){var b=this._slideIndexes[a],c=this._element.find('[data-slideshow="'+a+'"]'),d=c.find(".options .option");d.addClass("hidden"),$(d[b]).removeClass("hidden")},_setupPromoteSlideshows:function(){var a=this;this._element.find(".promoteOverlay .nav > a.left").click(function(b){b.preventDefault();{var c=$(this),d=c.data("slideshow"),e=c.closest(".promoteOverlay"),f=e.find(".options .option").length;e.find(".options .option")}0===a._slideIndexes[d]?a._slideIndexes[d]=f-1:--a._slideIndexes[d],a._showSlide(d)}),this._element.find(".promoteOverlay .nav > a.right").click(function(b){b.preventDefault();{var c=$(this),d=c.data("slideshow"),e=c.closest(".promoteOverlay"),f=e.find(".options .option").length;e.find(".options .option")}a._slideIndexes[d]===f-1?a._slideIndexes[d]=0:++a._slideIndexes[d],a._showSlide(d)})},_setupWalkPromoteModalEvents:function(){var a=this;this._element.find(".walkPromoteOverlay").find(".icon-twitter").click(function(b){b.preventDefault();var c=$(this).closest(".option").find(".copy");a._showTwitterShareWindow("http://janeswalk.org"+c.data("walkpath"),c.text().trim())}),this._element.find(".walkPromoteOverlay").find(".icon-facebook").click(function(b){b.preventDefault();var c=$(this).closest(".option").find(".copy");a._showFacebookShareWindow("http://janeswalk.org"+c.data("walkpath"),"Jane's Walk",c.text().trim())}),this._element.find(".walkPromoteOverlay").find(".icon-envelope").click(function(b){b.preventDefault();var c=$(this).closest(".option").find(".copy");a._showEmailShareWindow("Jane's Walk in "+a._element.find("#profileWrapper").data("city"),c.text().trim())})},_showCurrentTab:function(){this._element.find("ul.nav-tabs li.active").removeClass("active"),this._element.find('ul.nav-tabs li a[data-tab="'+this._currentTab+'"]').parent().addClass("active"),this._element.find("div.content div.block").addClass("hidden"),this._element.find('div.content div.block[data-tab="'+this._currentTab+'"]').removeClass("hidden"),location.hash="tab="+this._currentTab},_showEmailShareWindow:function(a,b){a=encodeURIComponent(a),b=encodeURIComponent(b);var c="mailto:?subject="+a+"&body="+b;window.open(c)},_showFacebookShareWindow:function(a,b,c){new FacebookShareDialog({link:a,name:b,description:c}).show()},_showProperStep:function(){if(""!==location.hash){var a,b=location.hash.split("&"),c={};$(b).each(function(b,d){a=d.split("="),c[a[0].replace("#","")]=a[1]}),this._currentTab=c.tab,this._showCurrentTab(),"undefined"!=typeof c.success&&1===parseInt(c.success)&&this._element.find('div.content div.block[data-tab="'+this._currentTab+'"]').addClass("success")}},_showTwitterShareWindow:function(a,b){a=encodeURIComponent(a),b=encodeURIComponent(b),b.length>130&&(b=b.substring(0,130)+"..."),a="https://twitter.com/intent/tweet?url="+a+"&via=janeswalk&text="+b,window.open(a,"Twitter Share","width=640, height=320")}}),WalkPageView=PageView.extend({init:function(a){this._super(a),this._addFacebookDialogEvents(),this._initializeMap()},_addFacebookDialogEvents:function(){var a=this;this._element.find(".facebookShareLink").click(function(b){b.preventDefault(),a.trackEvent("Walk","share.attempted","facebook");var c=a._getFacebookDialogObj();new FacebookShareDialog(c).show(a._facebookShareFailed,a._facebookShareSuccessful)})},_facebookShareFailed:function(){this.trackEvent("Walk","share.failed","facebook")},_facebookShareSuccessful:function(){this.trackEvent("Walk","share.successful","facebook")},_getFacebookDialogObj:function(){return{link:JanesWalk.page.url,picture:JanesWalk.page.pictureUrl,name:JanesWalk.page.title,description:JanesWalk.page.description,actions:{name:"View Jane's Walks in "+JanesWalk.page.city.name,link:JanesWalk.page.city.url}}},_styledMap:new google.maps.StyledMapType([{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{visibility:"on"},{saturation:-100}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{saturation:-100}]},{featureType:"landscape.natural",stylers:[{saturation:-100},{lightness:36}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{visibility:"on"},{saturation:37}]},{featureType:"landscape.man_made",stylers:[{saturation:-100}]}],{name:"Styled Map"}),_initializeMap:function(){var a,b,c,d,e=[],f="undefined"==typeof zoomLevelset?16:zoomLevelset,g={zoom:f,scrollwheel:!1,zoomControl:!0,disableDefaultUI:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},h=new google.maps.Map(document.getElementById("map-canvas"),g),i=[],j="../../../../img/marker.png",k=new google.maps.InfoWindow({maxWidth:300}),l=new InfoBox({content:document.getElementById("infobox"),maxWidth:150,pixelOffset:new google.maps.Size(-3,-25),alignBottom:!0,boxStyle:{background:"#fff",width:"280px",padding:"10px",border:"1px solid #eee"},closeBoxMargin:"-22px -22px 2px -8px",closeBoxURL:"../../../../img/map-close.png",infoBoxClearance:new google.maps.Size(20,20)}),m=function(a,b,c){return function(){for(var d=0;d<e.length;d++)e[d].setIcon(o);h.panTo(a.getPosition()),this.setIcon(n),k.setContent("<h4>"+JanesWalk.page.gmap.markers[b].title+"</h4><p>"+JanesWalk.page.gmap.markers[b].description+"</p>"+c),l.setContent("<h4>"+JanesWalk.page.gmap.markers[b].title+"</h4><p>"+JanesWalk.page.gmap.markers[b].description+"</p>"+c),l.open(h,a),$(".walk-stop").removeClass("active"),$(".walk-stops-meta #"+b).addClass("active");$(".active");$(".walk-stops-meta").mCustomScrollbar("scrollTo",".active")}},n=new google.maps.MarkerImage("../../../../img/marker-active.png"),o=new google.maps.MarkerImage("../../../../img/marker.png");for(b in JanesWalk.page.gmap.route)i.push(new google.maps.LatLng(JanesWalk.page.gmap.route[b].lat,JanesWalk.page.gmap.route[b].lng));a=new google.maps.Polyline({path:i,strokeColor:"#F16725",strokeOpacity:.8,strokeWeight:4}),a.setMap(h),h.mapTypes.set("map_style",this._styledMap),h.setMapTypeId("map_style");for(var p in JanesWalk.page.gmap.markers)marker=new google.maps.Marker({position:new google.maps.LatLng(JanesWalk.page.gmap.markers[p].lat,JanesWalk.page.gmap.markers[p].lng),map:h,icon:j,id:p}),e.push(marker),d="",$("body").hasClass("create-page")&&(d="<button class='btn pull-right' id='delete-marker'><i class='icon-trash'><i></button>"),google.maps.event.addListener(marker,"click",m(marker,p,d));$(".walk-stops").show();var q=new google.maps.LatLngBounds;for(c in e)q.extend(e[c].getPosition());for(c in a.getPath().getArray())q.extend(a.getPath().getAt(c));e.length>0&&h.fitBounds(q),google.maps.event.addListenerOnce(h,"zoom_changed",function(){var a=h.getZoom();h.setZoom(Math.min(16,a))}),google.maps.event.addDomListener(document.getElementById("map-canvas"),"touchstart",function(){h.setOptions({panControl:!1,draggable:!1})}),google.maps.event.addListener(marker,"dragend",function(){var a=marker.getPosition();h.panTo(a),document.getElementById("txt_latlng").value=a.lat()+", "+a.lng()}),google.maps.event.addListenerOnce(k,"domready",function(){google.maps.event.addDomListener(document.getElementById("save-marker"),"click",function(){k.close(h,marker)})}),$(".walk-stop").on("click",function(){marker=e[this.id],$(".walk-stop").removeClass("active"),$(this).addClass("active"),google.maps.event.trigger(marker,"click")})}});if(Function.prototype.bind||(Function.prototype.bind=function(a){"use strict";if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),function(){"use strict";var a=Object.prototype,b=a.__defineGetter__,c=a.__defineSetter__,d=a.__lookupGetter__,e=a.__lookupSetter__,f=a.hasOwnProperty;b&&c&&d&&e&&(Object.defineProperty||(Object.defineProperty=function(a,g,h){if(arguments.length<3)throw new TypeError("Arguments not optional");if(g+="",f.call(h,"value")&&(!d.call(a,g)&&!e.call(a,g)&&(a[g]=h.value),f.call(h,"get")||f.call(h,"set")))throw new TypeError("Cannot specify an accessor and a value");if(!(h.writable&&h.enumerable&&h.configurable))throw new TypeError("This implementation of Object.defineProperty does not support false for configurable, enumerable, or writable.");return h.get&&b.call(a,g,h.get),h.set&&c.call(a,g,h.set),a}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(a,b){if(arguments.length<2)throw new TypeError("Arguments not optional.");b+="";var c={configurable:!0,enumerable:!0,writable:!0},g=d.call(a,b),h=e.call(a,b);return f.call(a,b)?g||h?(delete c.writable,c.get=c.set=void 0,g&&(c.get=g),h&&(c.set=h),c):(c.value=a[b],c):c}),Object.defineProperties||(Object.defineProperties=function(a,b){var c;for(c in b)f.call(b,c)&&Object.defineProperty(a,c,b[c])}))}(),!(document.documentElement.dataset||Object.getOwnPropertyDescriptor(Element.prototype,"dataset")&&Object.getOwnPropertyDescriptor(Element.prototype,"dataset").get)){var propDescriptor={enumerable:!0,get:function(){"use strict";var a,b,c,d,e,f,g=this,h=this.attributes,i=h.length,j=function(a){return a.charAt(1).toUpperCase()},k=function(){return this},l=function(a,b){return"undefined"!=typeof b?this.setAttribute(a,b):this.removeAttribute(a)};try{({}).__defineGetter__("test",function(){}),b={}}catch(m){b=document.createElement("div")}for(a=0;i>a;a++)if(f=h[a],f&&f.name&&/^data-\w[\w\-]*$/.test(f.name)){c=f.value,d=f.name,e=d.substr(5).replace(/-./g,j);try{Object.defineProperty(b,e,{enumerable:this.enumerable,get:k.bind(c||""),set:l.bind(g,d)})}catch(n){b[e]=c}}return b}};try{Object.defineProperty(Element.prototype,"dataset",propDescriptor)}catch(e){propDescriptor.enumerable=!1,Object.defineProperty(Element.prototype,"dataset",propDescriptor)}}var _pageView;$(document).ready(function(){function a(){$month.html(g.getMonthName()),$year.html(g.getYear())}function b(a){$(".caption .book").remove(),$(".caption .request-btn-book").remove(),$(".request").slideUp(),$(".request-btn").removeClass("active"),$(".date-caption").append(a.html())}var c,d,e=$("body").first(),f=e.attr("data-pageViewName");"undefined"==typeof f?console&&console.log("No page view defined."):_pageView=new window[f](e);var g=$("#calendar").calendario({displayWeekAbbr:!0,startIn:0,onDayClick:function(a,c,d){$(".fc-row div").removeClass("selected"),a.addClass("selected"),c.length>0?($(".request-btn, .request-nowalks").hide(),b(c,d)):($(".caption .book").remove(),$(".caption .request-btn-book").remove(),$(".request-nowalks, .request-btn").show()),$("body").hasClass("create-page")&&$("#selected-day").html(d.monthname+" "+d.day+", "+d.year)}});($("body").hasClass("walk-page")||$("body").hasClass("create-page"))&&($month=$("#custom-month").html(g.getMonthName()),$year=$("#custom-year").html(g.getYear())),$("#custom-next").on("click",function(){g.gotoNextMonth(a)}),$("#custom-prev").on("click",function(){g.gotoPreviousMonth(a)}),$(".fc-content").tooltip({trigger:"hover",title:"I'm available"}),$(".tag").tooltip({trigger:"hover",placement:"bottom"}),$(".date-caption").delegate(".request-btn-book, .request-btn","click",function(a){a.preventDefault(),$(this).toggleClass("active"),$(".request").slideToggle()}),$(".walk-stops-meta").mCustomScrollbar({theme:"dark"}),$("#step-add-button-final").on("click",function(){$("#step-add-button").animate({opacity:"1"})}),$(".notification").on("click",function(){$(this).removeClass("expanded")}),$("body").hasClass("city-page")&&"undefined"==typeof festivalWeekendCheck&&(setTimeout(function(){$(".notification.festival-weekend").addClass("expanded")},2e3),$(".city-page").on("click",function(){$(".notification.festival-weekend").removeClass("expanded")})),$("body").hasClass("home")&&setTimeout(function(){$("#prototype").modal("show")},2e3),$(".custom-walk-page .container-outter .notify").on("click",function(a){a.preventDefault(),$(".notification.custom-form").toggleClass("expanded")}),$("body").on("mousedown",function(){$(".notification").hasClass("expanded")&&$(".notification").removeClass("expanded")}),$(".bottom-bar").on("click",function(a){a.preventDefault(),$("html, body").animate({scrollTop:$("#walk-leader-bio").offset().top-80},1e3)}),$("#register-btn").on("click",function(a){a.preventDefault(),$("html, body").animate({scrollTop:$("#register").offset().top-80},1e3,function(){setTimeout(function(){$("#register").addClass("focus")},100)})}),$("body").hasClass("reg-confirmation")?(c=url("?eid"),d=url("?oid"),document.getElementById("button-regdonate").href="http://janeswalk.tv/confirm?event_id="+c+"&order_id="+d):$("body").hasClass("reg-confirmation-riverside-walk")?(c=url("?eid"),d=url("?oid"),document.getElementById("button-regdonate").href="http://janeswalk.tv/confirm-riverside?event_id="+c+"&order_id="+d):$("body").hasClass("reg-confirmation-congested")&&(c=url("?eid"),d=url("?oid"),document.getElementById("button-regdonate").href="http://janeswalk.tv/confirm-congested?event_id="+c+"&order_id="+d)});