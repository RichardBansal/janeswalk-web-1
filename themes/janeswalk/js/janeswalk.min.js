!function e(t,n,a){function i(s,r){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return i(n?n:e)},d,d.exports,e,t,n,a)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)i(a[s]);return i}({1:[function(e){PageViews={PageView:e("./v2/views/Page.jsx"),CityPageView:e("./v2/views/pages/City.jsx"),HomePageView:e("./v2/views/pages/Home.jsx"),ProfilePageView:e("./v2/views/pages/Profile.jsx"),WalkPageView:e("./v2/views/pages/Walk.jsx")},document.addEventListener("DOMContentLoaded",function(){var e=document.body.getAttribute("data-pageViewName")||"PageView";try{new PageViews[e]($(document.body))}catch(t){console.log("Error instantiating page view "+e+": "+t)}var n=document.getElementById("ccm-toolbar");n&&window.addEventListener("keyup",function(e){if("INPUT"!==e.target.tagName)switch(e.preventDefault(),String(e.key||e.keyCode&&String.fromCharCode(e.keyCode)||e.char).toUpperCase()){case"M":n.style&&(n.style.zIndex=99999==n.style.zIndex?-1:99999)}})})},{"./v2/views/Page.jsx":5,"./v2/views/pages/City.jsx":6,"./v2/views/pages/Home.jsx":7,"./v2/views/pages/Profile.jsx":8,"./v2/views/pages/Walk.jsx":9}],2:[function(){!function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function a(){!e&&this.init&&this.init.apply(this,arguments)}var i=this.prototype,o=function(e,t){return function(){var n=this._super;this._super=i[e];var a=t.apply(this,arguments);return this._super=n,a}};e=!0;var s=new this;e=!1;for(var r in n)s[r]="function"==typeof n[r]&&"function"==typeof i[r]&&t.test(n[r])?o(r,n[r]):n[r];return a.prototype=s,a.prototype.constructor=a,a.extend=arguments.callee,a}}()},{}],3:[function(){if(Function.prototype.bind||(Function.prototype.bind=function(e){"use strict";if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,a=function(){},i=function(){return n.apply(this instanceof a&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return a.prototype=this.prototype,i.prototype=new a,i}),function(){"use strict";var e=Object.prototype,t=e.__defineGetter__,n=e.__defineSetter__,a=e.__lookupGetter__,i=e.__lookupSetter__,o=e.hasOwnProperty;t&&n&&a&&i&&(Object.defineProperty||(Object.defineProperty=function(e,s,r){if(arguments.length<3)throw new TypeError("Arguments not optional");if(s+="",o.call(r,"value")&&(!a.call(e,s)&&!i.call(e,s)&&(e[s]=r.value),o.call(r,"get")||o.call(r,"set")))throw new TypeError("Cannot specify an accessor and a value");if(!(r.writable&&r.enumerable&&r.configurable))throw new TypeError("This implementation of Object.defineProperty does not support false for configurable, enumerable, or writable.");return r.get&&t.call(e,s,r.get),r.set&&n.call(e,s,r.set),e}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(e,t){if(arguments.length<2)throw new TypeError("Arguments not optional.");t+="";var n={configurable:!0,enumerable:!0,writable:!0},s=a.call(e,t),r=i.call(e,t);return o.call(e,t)?s||r?(delete n.writable,n.get=n.set=void 0,s&&(n.get=s),r&&(n.set=r),n):(n.value=e[t],n):n}),Object.defineProperties||(Object.defineProperties=function(e,t){var n;for(n in t)o.call(t,n)&&Object.defineProperty(e,n,t[n])}))}(),!(document.documentElement.dataset||Object.getOwnPropertyDescriptor(Element.prototype,"dataset")&&Object.getOwnPropertyDescriptor(Element.prototype,"dataset").get)){var e={enumerable:!0,get:function(){"use strict";var e,t,n,a,i,o,s=this,r=this.attributes,l=r.length,c=function(e){return e.charAt(1).toUpperCase()},d=function(){return this},f=function(e,t){return"undefined"!=typeof t?this.setAttribute(e,t):this.removeAttribute(e)};try{({}).__defineGetter__("test",function(){}),t={}}catch(h){t=document.createElement("div")}for(e=0;l>e;e++)if(o=r[e],o&&o.name&&/^data-\w[\w\-]*$/.test(o.name)){n=o.value,a=o.name,i=a.substr(5).replace(/-./g,c);try{Object.defineProperty(t,i,{enumerable:this.enumerable,get:d.bind(n||""),set:f.bind(s,a)})}catch(p){t[i]=n}}return t}};try{Object.defineProperty(Element.prototype,"dataset",e)}catch(t){e.enumerable=!1,Object.defineProperty(Element.prototype,"dataset",e)}}Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t,n=Object(e),a=!1,i=1;i<arguments.length;i++){var o=arguments[i];if(void 0!==o&&null!==o){for(var s=Object.keys(Object(o)),r=0,l=s.length;l>r;r++){var c=s[r];try{var d=Object.getOwnPropertyDescriptor(o,c);void 0!==d&&d.enumerable&&(n[c]=o[c])}catch(f){a||(a=!0,t=f)}}if(a)throw t}}return n}})},{}],4:[function(e,t){e("../extend.js"),e("../shims.js");var n=window.Class,a=n.extend({_element:null,init:function(e){this._element=e},getElement:function(){return this._element}});t.exports=a},{"../extend.js":2,"../shims.js":3}],5:[function(e,t){var n=e("../View.jsx"),a=n.extend({init:function(e){this._super(e),this._addNavEvents(),this._addOverlayCloseEvent()},_addOverlayCloseEvent:function(){var e=this;this._element.find(".o-background").click(function(){e._element.find(".overlay").hide()}),this._element.find("a.closeModalCta").click(function(t){t.preventDefault(),e._element.find(".overlay").hide()})},_addNavEvents:function(){this._element.find("a.search-open").click(function(){$("html, body").animate({scrollTop:0},300),$("body > header").addClass("dropped")}),this._element.find("a.search-close").click(function(){$("body > header").removeClass("dropped")})},_makeGaCall:function(e){_gaq.push(e)},trackCustomVar:function(e,t,n,a){var i=["_setCustomVar",e,t,n,a];this._makeGaCall(i)},trackEvent:function(e,t,n,a,i){var o=["_trackEvent"];void 0!==e&&o.push(e),void 0!==t&&o.push(t),void 0!==n&&o.push(n),void 0!==a&&o.push(a),this._makeGaCall(o,i)},trackView:function(e){var t=["_trackPageview",e];this._makeGaCall(t)}});t.exports=a},{"../View.jsx":4}],6:[function(e,t){var n=e("../Page.jsx"),a=n.extend({_accessibility:null,_cards:null,_data:null,_date:null,_initiative:null,_theme:null,_ward:null,init:function(e){this._super(e),this._cards=this._element[0].querySelectorAll(".walk"),this._previewCards(),this._data=JanesWalk.walks,this._resetSelectElements(),this._addCreateWalkEvent(),this._addFilterEvents(),this._setThemeCounts(),this._captureHash(),this._addLinkListeners(),$(".walks-list .tag").tooltip()},_getFacebookDialogDonateObj:function(){return{link:"http://janeswalk.org",name:"Jane's Walk"}},_previewCards:function(){for(var e=Array.prototype.slice.call(this._cards).sort(function(){return.5-Math.random()}),t=document.querySelector(".ccm-block-page-list-walk-filters .walk-preview"),n=0,a=Math.min(e.length,9);a>n;n++){var i=e[n].cloneNode(!0);t.appendChild(i)}},_addLinkListeners:function(){var e=document.querySelector("a.see-all");e&&e.addEventListener("click",function(){document.querySelector(".ccm-block-page-list-walk-filters").classList.add("filtering"),e.parentNode.removeChild(e)})},_setupText2DonateInterstitials:function(){var e,t,n,a,i=!1,o=this,s=null!==location.pathname.match(/\/canada\/[^/]+/);this._element.find("a.closeCatfishCta").click(function(e){e.preventDefault(),o._element.find(".catfish").hide(),jQuery.cookie("hasSeenDonateCatfish","1",{path:"/",domain:location.host})}),i&&s===!0&&(e=null!==jQuery.cookie("hasSeenDonateInterstitial")&&"undefined"!=typeof jQuery.cookie("hasSeenDonateInterstitial"),e===!1?(t=function(){jQuery.cookie("hasSeenDonateInterstitial","1",{path:"/",domain:location.host}),o._element.find(".catfish.c-donate").removeClass("hidden")},this._element.find(".overlay.o-donate").show(),this._element.find(".overlay.o-donate .o-background").click(t),this._element.find("a.closeModalCta").click(t),this._element.find("div.btnWrapper a").click(function(e){jQuery.cookie("hasSeenDonateInterstitial","1",{path:"/",domain:location.host}),jQuery.cookie("hasSeenDonateCatfish","1",{path:"/",domain:location.host}),e.preventDefault(),o._element.find(".o-donate").hide(),o._element.find(".o-shout").show(),o._element.find(".o-shout .icon-twitter").click(function(e){e.preventDefault(),n=encodeURIComponent("http://janeswalk.org/"),text=encodeURIComponent($(this).closest(".option").find(".copy").text().trim()),a="https://twitter.com/intent/tweet?url="+n+"&via=janeswalk&text="+text,window.open(a,"Twitter Share","width=640, height=320")}),o._element.find(".o-shout .icon-facebook").click(function(e){e.preventDefault();var t=o._getFacebookDialogDonateObj();t.description=$(this).closest(".option").find(".copy").text().trim(),new FacebookShareDialog(t).show()})})):(hasSeenDonateCatfish=null!==jQuery.cookie("hasSeenDonateCatfish")&&"undefined"!=typeof jQuery.cookie("hasSeenDonateCatfish"),hasSeenDonateCatfish===!1&&this._element.find(".catfish").removeClass("hidden")))},_setThemeCounts:function(){var e,t=this,n=Array.prototype.forEach,a=this._element[0],i=function(n){var a=n.getAttribute("value"),i=this.compare_fn||function(e,t){return e[t]};if("*"!==a){e=0;for(var o in t._data)i(t._data[o][this.filter],a)&&++e;n.textContent+=" ("+e+")",0===e&&n.parentElement.removeChild(n)}};n.call(a.querySelectorAll('div.filters select[name="theme"] option'),i,{filter:"themes"}),n.call(a.querySelectorAll('div.filters select[name="accessibility"] option'),i,{filter:"accessibilities"}),n.call(a.querySelectorAll('div.filters select[name="ward"] option'),i,{filter:"wards"}),n.call(a.querySelectorAll('div.filters select[name="initiative"] option'),i,{filter:"initiatives"}),n.call(a.querySelectorAll('div.filters select[name="date"] option'),i,{filter:"datetimes",compare_fn:function(e,t){for(var n=0;n<e.length;n++)return-1!==e[n].date.indexOf(t)}})},_resetSelectElements:function(){var e=this;this._element.find("div.filters select").each(function(e,t){$(t).val("*")}),this._element.find(".initiatives").addClass("hidden"),this._element.find(".initiative").addClass("hidden"),this._element.find("#initiative").change(function(){"#"!==$(this).val()&&(e._element.find(".initiatives").removeClass("hidden"),e._element.find('[data-jw-initiative="'+$(this).val()+'"]').removeClass("hidden"))})},_addCreateWalkEvent:function(){var e=this,t=this._element.find(".create-walk");t.click(function(t){t.preventDefault(),0===e._element.find('a[href="/index.php/login/logout/"]').length?e._element.find(".overlay.o-connect").show():location.href=$(this).attr("href")})},_captureHash:function(){var e=this;""!==location.hash&&(pieces=location.hash.replace("#","").split("&"),key="",$(pieces).each(function(t,n){key="_"+n.split("=")[0],e[key]=n.split("=")[1]}),this._filterCards(),this._element.find('select[name="ward"]').val(this._ward),this._element.find('select[name="theme"]').val(this._theme),this._element.find('select[name="accessibility"]').val(this._accessibility),this._element.find('select[name="initiative"]').val(this._initiative),this._element.find('select[name="date"]').val(this._date))},_setHash:function(){location.hash="ward="+this._ward+"&theme="+this._theme+"&accessibility="+this._accessibility+"&initiative="+this._initiative+"&date="+this._date},_filterCards:function(){var e,t,n=this,a=0,i=function(e,t){return"*"===e||t&&t[e]};for(e=0,t=this._cards.length;t>e;e++)this._cards[e].classList.add("hidden");this._data.forEach(function(t,o){i(n._ward,t.wards)&&i(n._theme,t.themes)&&i(n._accessibility,t.accessibilities)&&i(n._initiative,t.initiatives)&&function(t,n){if("*"===n)return!0;for(e=0;e<t.length;e++)return-1!==t[e].date.indexOf(n)}(t.datetimes,n._date)&&(++a,n._cards[o].classList.remove("hidden"))}),this._element.find(".empty").addClass("hidden"),0===a&&this._element.find(".empty").removeClass("hidden")},_addFilterEvents:function(){var e=this;this._element.find("div.filters select").change(function(t){t.preventDefault(),e._ward="*",e._element.find('select[name="ward"]').length>0&&(e._ward=e._element.find('select[name="ward"]').val()),e._theme="*",e._element.find('select[name="theme"]').length>0&&(e._theme=e._element.find('select[name="theme"]').val()),e._accessibility="*",e._element.find('select[name="accessibility"]').length>0&&(e._accessibility=e._element.find('select[name="accessibility"]').val()),e._initiative="*",e._element.find('select[name="initiative"]').length>0&&(e._initiative=e._element.find('select[name="initiative"]').val()),e._date="*",e._element.find('select[name="date"]').length>0&&(e._date=e._element.find('select[name="date"]').val()),e._setHash(),e._filterCards()})}});t.exports=a},{"../Page.jsx":5}],7:[function(e,t){var n=e("../Page.jsx"),a=n.extend({init:function(e){this._super(e),this._addMapToggleEvents(),this._addCityLookup(),this._addBgImage(),this._addCityDropdownEvent(),this._addCreateWalkEvent()},_addCreateWalkEvent:function(){var e=this,t=this._element.find('.calltoaction li a[href="/walk/form/"]');t.click(function(t){t.preventDefault(),e._element.find('a[href="/index.php/login/logout/"]').length?location.href=$(this).attr("href"):e._element.find(".overlay").show()})},_addCityDropdownEvent:function(){var e=this._element.find("select.pageListSelect");e.change(function(){location.href=e.val()})},_addBgImage:function(){var e=this._element.attr("data-backgroundImageUrl"),t=this._element.find(".backgroundImageBanner"),n=document.createElement("img");n.onload=function(){t.css({backgroundImage:"url("+e+")"}),t.removeClass("faded")},n.src=e},_addCityCalloutCta:function(e,t){React.render(document.getElementById("ccm-jw-page-list-typeahead"),React.createElement("h3",null,"See walks in ",React.createElement("a",{href:t},e),", or:"))},_addCityButtonCta:function(e,t){React.render(this._element.find(".calltoaction ul").first(),React.createElement("li",{className:"cityButtonCta"},React.createElement("a",{href:t,className:"btn btn-primary"},"View walks in ",e)))},_addCityLookup:function(){var e=this;window.freeGeoIpCallback=function(t){if("undefined"!=typeof t){var n=e._element.find("div.ccm-page-list-typeahead ul li a");n.each(function(n,a){$(a).text()===t.city&&(e._addCityCalloutCta(t.city,$(a).attr("href")),e._addCityButtonCta(t.city,$(a).attr("href")))})}},void 0===JanesWalk.user||void 0===JanesWalk.user.city?$.getScript("http://freegeoip.net/json/?callback=freeGeoIpCallback"):(e._addCityCalloutCta(JanesWalk.user.city.name,JanesWalk.user.city.url),e._addCityButtonCta(JanesWalk.user.city.name,JanesWalk.user.city.url))},_addMapToggleEvents:function(){var e=this._element.find(".overlap .controls a.showButton"),t=this._element.find(".overlap .controls a.closeButton");e.click(function(){$(".overlap").addClass("fullmap"),$(this).fadeOut(400,function(){t.fadeIn()}),$("html, body").animate({scrollTop:$(this).offset().top-100},800)}),t.click(function(){$(".overlap").removeClass("fullmap"),$(this).fadeOut(400,function(){e.fadeIn()})})}});t.exports=a},{"../Page.jsx":5}],8:[function(e,t){var n=e("../Page.jsx"),a=n.extend({_slideIndexes:{blogPost:0,city:0,walk:0},_currentTab:null,init:function(e){try{this._super(e),this._showProperStep(),this._addTabClickEvents(),this._setupDisplayPictureFlashWidget(),this._addPictureDeleteEvent(),this._addPromoteWalkClickEvent(),this._addPromoteCityClickEvent(),this._addPromoteBlogPostClickEvent(),this._setupCityPromoteModalEvents(),this._setupWalkPromoteModalEvents(),this._setupBlogPostPromoteModalEvents(),this._setupPromoteSlideshows(),this._setupTransferWalkEvents()}catch(t){console.log("Error initializing profile: "+t)}},_addPictureDeleteEvent:function(){this._element.find('a[href="/index.php/profile/delete/"]').click(function(e){e.preventDefault(),$.ajax({type:"DELETE",url:$(this).attr("href"),success:function(){location.href="/index.php/profile/#tab=picture&success=1"}})})},_addPromoteBlogPostClickEvent:function(){var e=this,t=this._element.find(".column.blogPosts .subactions .promote");t.click(function(t){t.preventDefault();var n=e._getBlogPostObjById($(this).data("blogpostid"));e._element.find(".blogPostPromoteOverlay .copy").each(function(e,t){var a=$(t);a.data("blogpostpath",n.path),a.find(".objTitle").text(n.title)}),e._element.find(".blogPostPromoteOverlay").show()})},_addPromoteCityClickEvent:function(){var e=this,t=this._element.find("#cityBlock .promoteBtn");t.click(function(t){t.preventDefault(),e._element.find(".cityPromoteOverlay").show()})},_getBlogPostObjById:function(e){var t=this._element.find('[data-blogpostid="'+e+'"]');return{title:t.first().data("blogposttitle"),path:t.first().data("blogpostpath")}},_getWalkObjById:function(e){var t=this._element.find('[data-walkid="'+e+'"]');return{title:t.first().data("walktitle"),path:t.first().data("walkpath")}},_addPromoteWalkClickEvent:function(){var e=this,t=this._element.find(".column.city .subactions .promote,.column.walks .subactions .promote");t.click(function(t){t.preventDefault();var n=e._getWalkObjById($(this).data("walkid"));e._element.find(".walkPromoteOverlay .copy").each(function(e,t){var a=$(t);a.data("walkpath",n.path),a.find(".objTitle").text(n.title)}),e._element.find(".walkPromoteOverlay").show()})},_addTabClickEvents:function(){var e=this;this._element.find("ul.nav-tabs li a").click(function(t){t.preventDefault(),e._currentTab=$(this).attr("data-tab"),e._showCurrentTab()}),this._element.find(".tabLink").click(function(t){t.preventDefault(),e._currentTab=$(this).attr("data-tab"),e._showCurrentTab()})},_setupBlogPostPromoteModalEvents:function(){var e=this;this._element.find(".blogPostPromoteOverlay").find(".icon-twitter").click(function(t){t.preventDefault();var n=$(this).closest(".option").find(".copy");e._showTwitterShareWindow("http://janeswalk.org"+n.data("blogpostpath"),n.text().trim())}),this._element.find(".blogPostPromoteOverlay").find(".icon-facebook").click(function(t){t.preventDefault();var n=$(this).closest(".option").find(".copy");e._showFacebookShareWindow("http://janeswalk.org"+n.data("blogpostpath"),"Jane's Walk",n.text().trim())}),this._element.find(".blogPostPromoteOverlay").find(".icon-envelope").click(function(t){t.preventDefault();var n=$(this).closest(".option").find(".copy");e._showEmailShareWindow("Jane's Walk in "+e._element.find("#profileWrapper").data("city"),n.text().trim())})},_setupCityPromoteModalEvents:function(){var e=this._element.find(".cityPromoteOverlay").data("citypath"),t=this._element.find(".cityPromoteOverlay").data("cityname"),n=this;this._element.find(".cityPromoteOverlay").find(".icon-twitter").click(function(t){t.preventDefault(),n._showTwitterShareWindow("http://janeswalk.org"+e,$(this).closest(".option").find(".copy").text().trim())}),this._element.find(".cityPromoteOverlay").find(".icon-facebook").click(function(t){t.preventDefault(),n._showFacebookShareWindow("http://janeswalk.org"+e,"Jane's Walk",$(this).closest(".option").find(".copy").text().trim())}),this._element.find(".cityPromoteOverlay").find(".icon-envelope").click(function(e){e.preventDefault(),n._showEmailShareWindow("Jane's Walk in "+t,$(this).closest(".option").find(".copy").text().trim())})},_setupTransferWalkEvents:function(){var e=this;this._element.find("#walk-transfer .users a").click(function(e){e.preventDefault(),$.get(this.getAttribute("href"),function(e){e.error?alert(e.error):window.location=window.location})}),this._element.find("a.transfer").removeClass("hidden").click(function(t){t.preventDefault();for(var n=e._element.find("#walk-transfer"),a=this.getAttribute("href"),i=n.find(".users a"),o=0,s=i.length;s>o;o++)i[o].setAttribute("href",a+"transfer/"+i[o].getAttribute("data-uid"));n.modal()})},_setupDisplayPictureFlashWidget:function(){window.ThumbnailBuilder_onSaveCompleted=function(){location.href="/index.php/profile/#tab=picture&success=1"};var e={bgcolor:"#ffffff",wmode:"transparent",quality:"high"},t={width:this._element.find("#flashContainer").attr("data-width"),height:this._element.find("#flashContainer").attr("data-height"),image:this._element.find("#flashContainer").attr("data-imagepath"),save:this._element.find("#flashContainer").attr("data-savepath")};"undefined"!=typeof swfobject&&swfobject.embedSWF(this._element.find("#flashContainer").attr("data-flashpath"),"flashContainer","500","400","10,0,0,0","includes/expressInstall.swf",t,e)},_showSlide:function(e){var t=this._slideIndexes[e],n=this._element.find('[data-slideshow="'+e+'"]'),a=n.find(".options .option");a.addClass("hidden"),$(a[t]).removeClass("hidden")},_setupPromoteSlideshows:function(){var e=this;this._element.find(".promoteOverlay .nav > a.left").click(function(t){t.preventDefault();{var n=$(this),a=n.data("slideshow"),i=n.closest(".promoteOverlay"),o=i.find(".options .option").length;i.find(".options .option")}0===e._slideIndexes[a]?e._slideIndexes[a]=o-1:--e._slideIndexes[a],e._showSlide(a)}),this._element.find(".promoteOverlay .nav > a.right").click(function(t){t.preventDefault();{var n=$(this),a=n.data("slideshow"),i=n.closest(".promoteOverlay"),o=i.find(".options .option").length;i.find(".options .option")}e._slideIndexes[a]===o-1?e._slideIndexes[a]=0:++e._slideIndexes[a],e._showSlide(a)})},_setupWalkPromoteModalEvents:function(){var e=this;this._element.find(".walkPromoteOverlay").find(".icon-twitter").click(function(t){t.preventDefault();var n=$(this).closest(".option").find(".copy");e._showTwitterShareWindow("http://janeswalk.org"+n.data("walkpath"),n.text().trim())}),this._element.find(".walkPromoteOverlay").find(".icon-facebook").click(function(t){t.preventDefault();var n=$(this).closest(".option").find(".copy");e._showFacebookShareWindow("http://janeswalk.org"+n.data("walkpath"),"Jane's Walk",n.text().trim())}),this._element.find(".walkPromoteOverlay").find(".icon-envelope").click(function(t){t.preventDefault();var n=$(this).closest(".option").find(".copy");e._showEmailShareWindow("Jane's Walk in "+e._element.find("#profileWrapper").data("city"),n.text().trim())})},_showCurrentTab:function(){this._element.find("ul.nav-tabs li.active").removeClass("active"),this._element.find('ul.nav-tabs li a[data-tab="'+this._currentTab+'"]').parent().addClass("active"),this._element.find("div.content div.block").addClass("hidden"),this._element.find('div.content div.block[data-tab="'+this._currentTab+'"]').removeClass("hidden"),location.hash="tab="+this._currentTab},_showEmailShareWindow:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t);var n="mailto:?subject="+e+"&body="+t;window.open(n)},_showFacebookShareWindow:function(e,t,n){new FacebookShareDialog({link:e,name:t,description:n}).show()},_showProperStep:function(){if(""!==location.hash){var e,t=location.hash.split("&"),n={};$(t).each(function(t,a){e=a.split("="),n[e[0].replace("#","")]=e[1]}),this._currentTab=n.tab,this._showCurrentTab(),"undefined"!=typeof n.success&&1===parseInt(n.success)&&this._element.find('div.content div.block[data-tab="'+this._currentTab+'"]').addClass("success")}},_showTwitterShareWindow:function(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t),t.length>130&&(t=t.substring(0,130)+"..."),e="https://twitter.com/intent/tweet?url="+e+"&via=janeswalk&text="+t,window.open(e,"Twitter Share","width=640, height=320")}});t.exports=a},{"../Page.jsx":5}],9:[function(e,t){var n=e("../Page.jsx"),a=n.extend({init:function(e){this._super(e),this._addFacebookDialogEvents(),this._initializeMap()},_addFacebookDialogEvents:function(){var e=this;this._element.find(".facebookShareLink").click(function(t){t.preventDefault(),e.trackEvent("Walk","share.attempted","facebook");var n=e._getFacebookDialogObj();new FacebookShareDialog(n).show(e._facebookShareFailed,e._facebookShareSuccessful)})},_facebookShareFailed:function(){this.trackEvent("Walk","share.failed","facebook")},_facebookShareSuccessful:function(){this.trackEvent("Walk","share.successful","facebook")},_getFacebookDialogObj:function(){return{link:JanesWalk.page.url,picture:JanesWalk.page.pictureUrl,name:JanesWalk.page.title,description:JanesWalk.page.description,actions:{name:"View Jane's Walks in "+JanesWalk.page.city.name,link:JanesWalk.page.city.url}}},_styledMap:new google.maps.StyledMapType([{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{visibility:"on"},{saturation:-100}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{saturation:-100}]},{featureType:"landscape.natural",stylers:[{saturation:-100},{lightness:36}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{visibility:"on"},{saturation:37}]},{featureType:"landscape.man_made",stylers:[{saturation:-100}]}],{name:"Styled Map"}),_initializeMap:function(){var e,t,n,a,i=[],o="undefined"==typeof zoomLevelset?16:zoomLevelset,s={zoom:o,scrollwheel:!1,zoomControl:!0,disableDefaultUI:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},r=new google.maps.Map(document.getElementById("map-canvas"),s),l=[],c="../../../../img/marker.png",d=new google.maps.InfoWindow({maxWidth:300}),f=new InfoBox({content:document.getElementById("infobox"),maxWidth:150,pixelOffset:new google.maps.Size(-3,-25),alignBottom:!0,boxStyle:{background:"#fff",width:"280px",padding:"10px",border:"1px solid #eee"},closeBoxMargin:"-22px -22px 2px -8px",closeBoxURL:"../../../../img/map-close.png",infoBoxClearance:new google.maps.Size(20,20)}),h=function(e,t,n){return function(){for(var a=0;a<i.length;a++)i[a].setIcon(u);r.panTo(e.getPosition()),this.setIcon(p),d.setContent(React.renderToStaticMarkup(React.createElement("div",null,React.createElement("h4",null,JanesWalk.page.gmap.markers[t].title),React.createElement("p",null,JanesWalk.page.gmap.markers[t].description),n))),f.open(r,e),$(".walk-stop").removeClass("active"),$(".walk-stops-meta #"+t).addClass("active")}},p=new google.maps.MarkerImage("../../../../img/marker-active.png"),u=new google.maps.MarkerImage("../../../../img/marker.png");for(t in JanesWalk.page.gmap.route)l.push(new google.maps.LatLng(JanesWalk.page.gmap.route[t].lat,JanesWalk.page.gmap.route[t].lng));e=new google.maps.Polyline({path:l,strokeColor:"#F16725",strokeOpacity:.8,strokeWeight:4}),e.setMap(r),r.mapTypes.set("map_style",this._styledMap),r.setMapTypeId("map_style");for(var m in JanesWalk.page.gmap.markers)marker=new google.maps.Marker({position:new google.maps.LatLng(JanesWalk.page.gmap.markers[m].lat,JanesWalk.page.gmap.markers[m].lng),map:r,icon:c,id:m}),i.push(marker),a="",$("body").hasClass("create-page")&&(a=React.createElement("button",{className:"btn pull-right",id:"delete-marker"},React.createElement("i",{className:"fa fa-trash"}))),google.maps.event.addListener(marker,"click",h(marker,m,a));$(".walk-stops").show();var v=new google.maps.LatLngBounds;for(n in i)v.extend(i[n].getPosition());for(n in e.getPath().getArray())v.extend(e.getPath().getAt(n));i.length>0&&r.fitBounds(v),google.maps.event.addListenerOnce(r,"zoom_changed",function(){var e=r.getZoom();r.setZoom(Math.min(16,e))}),google.maps.event.addDomListener(document.getElementById("map-canvas"),"touchstart",function(){r.setOptions({panControl:!1,draggable:!1})}),google.maps.event.addListener(marker,"dragend",function(){var e=marker.getPosition();r.panTo(e),document.getElementById("txt_latlng").value=e.lat()+", "+e.lng()}),google.maps.event.addListenerOnce(d,"domready",function(){google.maps.event.addDomListener(document.getElementById("save-marker"),"click",function(){d.close(r,marker)})}),$(".walk-stop").on("click",function(){marker=i[this.id],$(".walk-stop").removeClass("active"),$(this).addClass("active"),google.maps.event.trigger(marker,"click")})}});t.exports=a},{"../Page.jsx":5}]},{},[1]);